
{{> header }}

<h1>Employee calendar</h1>

<div class="row">
    <div class="col-md-6 lead">{{logged_user.name}} {{logged_user.lastname}}'s calendar for {{this_year}}</div>
    <div class="col-md-6">
      <span class="pull-right">Allowance: {{#with current_user }}<span class="label label-info bigger">{{ this.calculate_number_of_days_available_in_allowence ../this_year }} out of {{this.calculate_total_number_of_days_n_allowence ../this_year}}{{/with}} days</span></span>
    </div>
</div>

{{> show_flash_messages }}

<div class="row">&nbsp;</div>

<div class="row main-row_header hidden-xs">
  <div class="col-md-12">Statistics of used leaves</div>
</div>

<div class="row hidden-xs">

  {{# if leave_type_statistics }}

    {{# each leave_type_statistics }}

      <div class="col-md-3 top-leave-type-statistics">
        <dl>
          <dt>{{this.days_taken}}</dt>
          <dd>{{this.leave_type.name}}</dd>
        </dl>
      </div>

    {{/each}}

  {{else}}

    <div class="col-md-3 text-muted">
      There are no leave requests yet.
    </div>

  {{/if}}


</div>

<div class="row hidden-xs">
  {{# if leave_type_statistics }}
  <div class="col-md-5"><hr class="hidden-xs"/></div>
  <div class="col-md-2 calendar-section-caption">
    {{# unless show_full_leave_type_statistic}}
    <a class="btn btn-default" href="/calendar/?show_full_leave_type_statistic=1">More statistics <span class="fa fa-chevron-down"></span></a>
    {{else}}
    <a class="btn btn-default" href="/calendar/">Less statistics <span class="fa fa-chevron-up"></span></a>
    {{/unless}}
  </div>
  <div class="col-md-5"><hr class="hidden-xs"/></div>
  {{else}}
    <div class="col-md-12"><hr class="hidden-xs"/></div>
  {{/if}}
</div>



<div class="row main-row_header">
  <div class="col-md-12">Calendar <a href="/calendar/feeds/" data-toggle="tooltip" data-placement="right" title="Export absences  to external calendars"><span class="fa fa-rss"></span></a></div>
</div>

<div class="row">
  <div class="col-md-2">
    {{#if show_full_year}}
    <a class="btn btn-default" href="/calendar/?year={{previous_year}}{{#if show_full_year}}&show_full_year=1{{/if}}"><span aria-hidden="true" class="fa fa-chevron-left"></span> {{previous_year}} </a>
    {{/if}}
  </div>
  <div class="col-md-8 calendar-section-caption">
    <strong>{{#if show_full_year}}January - December {{current_year}}{{else}}Upcoming Months{{/if}}</strong>
  </div>
  <div class="col-md-2">
    {{#if show_full_year}}
    <a class="btn btn-default pull-right" href="/calendar/?year={{next_year}}{{#if show_full_year}}&show_full_year=1{{/if}}">{{next_year}} <span aria-hidden="true" class="fa fa-chevron-right"></span></a>
    {{/if}}
  </div>
</div>

<div class="row">&nbsp;</div>

<div class="row clearfix">

    {{# each calendar}}
    <div class="col-md-3 month_container">
        <table class="calendar_month month_{{ this.month }}">
        <thead>
        <tr>
            <td colspan="14">{{#if ../show_full_year}}{{this.month}}{{else}}{{#with this.moment }}{{this.format 'MMMM, YYYY'}}{{/with}}{{/if}}</td>
        </tr>
        <tr>
            <td colspan="2">M</td>
            <td colspan="2">T</td>
            <td colspan="2">W</td>
            <td colspan="2">T</td>
            <td colspan="2">F</td>
            <td colspan="2">S</td>
            <td colspan="2">S</td>
        </tr>
        </thead>
        <tbody>
        {{#each this.weeks }}
        <tr>
            {{#each this}}
              {{> calendar_cell day = this}}
            {{/each}}
        </tr>
        {{/each}}

        </tbody></table>
    </div>
    {{/each}}

</div>



<div class="row">
  <div class="col-md-5"><hr class="hidden-xs"/></div>
  <div class="col-md-2 calendar-section-caption">
    {{# unless show_full_year}}
    <a class="btn btn-default" href="/calendar/?show_full_year=1">Show full {{current_year}} year <span class="fa fa-chevron-down"></span></a>
    {{else}}
    <a class="btn btn-default" href="/calendar/">Show nearest future <span class="fa fa-chevron-up"></span></a>
    {{/unless}}
  </div>
  <div class="col-md-5"><hr class="hidden-xs"/></div>
</div>


{{# unless show_full_year}}
  {{> user_requests leaves=current_user.my_leaves }}
{{/unless}}


{{> footer }}
